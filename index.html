<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>خريطة المشاريع الاستثمارية</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.control.layers.tree/L.Control.Layers.Tree.css" />
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script src="https://unpkg.com/leaflet.control.layers.tree/L.Control.Layers.Tree.js"></script>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      overflow: hidden;
      direction: rtl;
      font-family: 'Tajawal', sans-serif;
      font-size: 14pt;
    }
    #map {
      width: 100%;
      height: 100%;
    }
    .leaflet-popup-content {
      text-align: right;
    }
    .leaflet-control-layers {
      max-height: 100vh !important;
      overflow-y: auto !important;
      direction: rtl;
      text-align: right;
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script>
    var map = L.map("map");
    var allBounds = L.latLngBounds();
    var treeGroups = [];

    L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
      maxZoom: 19,
      attribution: "© OpenStreetMap"
    }).addTo(map);

    var groupLayers = {"group_1": {}, "group_2": {"صالة ألعاب أطفال": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "صالة مناسبات": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 1": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 2": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 3": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 4": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 5": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "كافتيريا 6": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مؤسسة تعليمية خاصة (روضة)": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مؤسسة تعليمية خاصة (روضة+مدرسة)": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مبنى الخدمات الفنية": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مبنى الهجرة والجوازات القديم": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مبنى خدمي في موقع المقصف العمالي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مجمع تجاري في جمعية التعليم العالي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مجمع تجاري في جمعية الزهراء": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مجمع تجاري في جمعية المهندسين": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مجمع تجاري في حلب الجديدة القطعة 268": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مركز السفريات": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مركز تجاري سياحي ثقافي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع السرايا القديمة (أرض السجن)": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع ثكنة طارق بن زياد": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع رحبة فيصل": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع سوق الأنتاج": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع مدينة ملاهي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "موقع مقصف ميامي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مول التجاري في سوق البشائر": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "نادي اجتماعي": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_3": {"سوق الهال": {"fillColor": "rgba(56, 218, 87, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_4": {"أرض في ريف المهندسين الثاني": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض مجبل نقابة المهندسين": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مطعم نقابة المهندسين الزربة": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مول المهندسين بشارع النيل": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض بلليرمون": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض خزانة التقاعد": {"fillColor": "rgba(166, 29, 225, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_5": {"الفوج 46": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الكلية الادارية كفرجوم": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "جمارك كفرجوم": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "١٠٠٩٧ دفاع": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "٧٩٠٧ و٧٩٠٨ دفاع": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "٧٩٠٩ و٧٩١٠ دفاع": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "١٢٧٢٨ انصاري دفاع": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "٩٧ دفاع": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "البحوث العلمية": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "اللواء 80": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_6": {"أرض الشيخ نجار": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض المسلمية": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض هنانو": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "العيادات العمالية": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المجمع العمالي": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مشفى الشيحان": {"fillColor": "rgba(255, 0, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_7": {"الشركة السورية للغزل و النسيج": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشركة العامة لصناعة و تسويق الاسمنت - عمران": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشركة العامة للزيوت": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشهباء للمفازل و المناسج": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "رحبة باصات النقل الداخلي": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "شركة زنوبيا وشمرا": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج أمية": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج الشرق": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج اللواء": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج الوحدة": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل ألبان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل التبغ - الريجي": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل الزجاج": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل السجاد": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل الشرق": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشركة الاهلية - معمل رقم 1": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشركة الاهلية - معمل رقم 2": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الشركة الاهلية معمل رقم 3": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج الثورة - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج الرصافة - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مستودع الاسطوانة - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مستودع الحكيم - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مستودع المنشاري - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مستودع سابا - مؤسسة الاقطان": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل عوف": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "شركة تاميكو - معمل السيرومات": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل الشاشات": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "الوحدة الاقتصادية - معمل الاسمنت": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "محلج تشرين": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل البطاريات": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل الجرارات": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "معمل الكابلات": {"fillColor": "rgba(255, 30, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_8": {"دائرة الشبكات": {"fillColor": "rgba(255, 206, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "دائرة الاليات - المراب": {"fillColor": "rgba(255, 206, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "دائرة الاليات - الكازية": {"fillColor": "rgba(255, 206, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "أرض مركز الجباية": {"fillColor": "rgba(255, 206, 0, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_9": {"حمام يلبغا الناصري": {"fillColor": "rgba(183, 201, 38, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_10": {"أرض حلب الجديدة بنيامين": {"fillColor": "rgba(164, 113, 88, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_11": {"غرفة زراعة حلب": {"fillColor": "rgba(167, 229, 141, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_12": {"رودكو الطرق والجسور": {"fillColor": "rgba(0, 0, 255, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_13": {"موارد مائية 31": {"fillColor": "rgba(49, 173, 236, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_14": {"العقار 16 ابوشيلم": {"fillColor": "rgba(205, 180, 39, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_15": {"بردة ايكاردا": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مداجن خان طومان": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "31 تابع للدواجن خان طومان": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "مداجن الزربة": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المنطقة الاولى 36 هكتار": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المنطقة الثانية 25 هكتار": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المنطقة الثالثة 28 هكتار": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المنطقة الرابعة 21 هكتار": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, "المنطقة الخامسة 30 هكتار": {"fillColor": "rgba(61, 193, 150, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_16": {"أرض للمالية": {"fillColor": "rgba(196, 60, 57, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_17": {"معسكر الشبية": {"fillColor": "rgba(58, 177, 252, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}, "group_18": {"كتلة السكك": {"fillColor": "rgba(208, 53, 154, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}, " ضاحية فيلات سكنية": {"fillColor": "rgba(208, 53, 154, 0.5019607843137255)", "fillOpacity": 0.5019607843137255, "color": "#232323", "weight": 0.26}}};
    var groupNames = {"group_1": "", "group_2": "مجلس مدينة حلب", "group_3": "المحافظة", "group_4": "نقابة المهندسين", "group_5": "وزارة الدفاع", "group_6": "اتحاد العمال", "group_7": "وزارة الصناعة", "group_8": "مؤسسة المياه", "group_9": "وزارة السياحة", "group_10": "غرفة التجارة", "group_11": "غرفة زراعة حلب", "group_12": "وزارة النقل", "group_13": "وزارة الطاقة", "group_14": "وزارة الإسكان", "group_15": "وزارة الزراعة", "group_16": "وزارة المالية", "group_17": "وزارة الإدارة المحلية", "group_18": "السكك الحديدية"};
    var groupObjects = {};
    for (let gid in groupLayers) {
      groupObjects[gid] = [];
    }

    fetch("layers_combined.geojson")
      .then(res => res.json())
      .then(data => {
        data.features.forEach(function(feature) {
          var props = feature.properties;
          var groupId = props["__group__"];
          var layerName = props["__layer__"];
          var style = groupLayers[groupId][layerName];

          var layer = L.geoJSON(feature, {
            style: style,
            onEachFeature: function (f, l) {
              var popup = "<table style='width:100%; text-align:right; border-collapse: collapse;'>";
              for (var key in props) {
                if (key === "__group__" || key === "__layer__") continue;
                var value = props[key];
                if (value !== null && value !== "") {
                  popup += "<tr><td style='background-color:#ccc; border:1px dotted #ccc; padding:4px;'><b>" + key + "</b></td>" +
                           "<td style='border:1px dotted #ccc; padding:4px;'>" + value + "</td></tr>";
                }
              }
              popup += "</table>";
              l.bindPopup(popup);
            }
          });

          layer.addTo(map);
          allBounds.extend(layer.getBounds());

          var labelHtml = "<span style='display:inline-block;width:12px;height:12px;margin-left:3px;margin-right:3px;vertical-align:middle;background-color:" + style.fillColor + ";opacity:" + style.fillOpacity + ";border:1px solid #333'></span>" + layerName;
          groupObjects[groupId].push({ label: labelHtml, layer: layer });
        });

        for (let gid in groupObjects) {
          var groupLabel = "<label><input type='checkbox' id='chk_" + gid + "' checked /> <b>" + groupNames[gid] + "</b></label>";
          treeGroups.push({
            label: groupLabel,
            children: groupObjects[gid],
            collapsed: true
          });

          setTimeout(() => {
            document.getElementById("chk_" + gid).addEventListener("change", function(e) {
              var checked = e.target.checked;
              groupObjects[gid].forEach(function(item) {
                if (checked) {
                  map.addLayer(item.layer);
                } else {
                  map.removeLayer(item.layer);
                }
              });
            });
          }, 500);
        }

        setTimeout(function() {
          map.fitBounds(allBounds);
          L.control.layers.tree(null, treeGroups, {
            collapsed: false,
            position: "topright"
          }).addTo(map);
        }, 1000);
      });
  </script>
</body>
</html>